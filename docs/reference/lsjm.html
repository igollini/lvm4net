<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Latent Space Joint Model — lsjm • lvm4net</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Latent Space Joint Model — lsjm" />

<meta property="og:description" content="Function to joint modelling of multiple network views using the Latent Space Jont Model (LSJM) Gollini and Murphy (2016). 
The LSJM merges the information given by the multiple network views by assuming that the probability of a node being connected with other nodes in each view is explained by a unique latent variable." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lvm4net</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/igollini/lvm4net">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Latent Space Joint Model</h1>
    <small class="dont-index">Source: <a href='https://github.com/igollini/lvm4net/blob/master/R/lsjm.R'><code>R/lsjm.R</code></a></small>
    <div class="hidden name"><code>lsjm.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Function to joint modelling of multiple network views using the Latent Space Jont Model (LSJM) Gollini and Murphy (2016). 
The LSJM merges the information given by the multiple network views by assuming that the probability of a node being connected with other nodes in each view is explained by a unique latent variable.</p>
    
    </div>

    <pre class="usage"><span class='fu'>lsjm</span>(<span class='no'>Y</span>, <span class='no'>D</span>, <span class='kw'>sigma</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>xi</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>0</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/length'>length</a></span>(<span class='no'>Y</span>)), <span class='kw'>psi2</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>2</span>,
  <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/length'>length</a></span>(<span class='no'>Y</span>)), <span class='kw'>Niter</span> <span class='kw'>=</span> <span class='fl'>500</span>, <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fl'>0.1</span>^<span class='fl'>2</span>, <span class='kw'>preit</span> <span class='kw'>=</span> <span class='fl'>20</span>,
  <span class='kw'>randomZ</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Y</th>
      <td><p>list containing a (<code>N</code> x <code>N</code>) binary adjacency matrix for each network view.</p></td>
    </tr>
    <tr>
      <th>D</th>
      <td><p>integer dimension of the latent space</p></td>
    </tr>
    <tr>
      <th>sigma</th>
      <td><p>(<code>D</code> x <code>D</code>) variance/covariance matrix of the prior distribution for the latent positions. Default <code>sigma = 1</code></p></td>
    </tr>
    <tr>
      <th>xi</th>
      <td><p>vector of means of the prior distributions of \(\alpha\). Default <code>xi = 0</code></p></td>
    </tr>
    <tr>
      <th>psi2</th>
      <td><p>vector of variances of the prior distributions of \(\alpha\). Default <code>psi2 = 2</code></p></td>
    </tr>
    <tr>
      <th>Niter</th>
      <td><p>maximum number of iterations. Default <code>Niter = 500</code></p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>desired tolerance. Default <code>tol = 0.1^2</code></p></td>
    </tr>
    <tr>
      <th>preit</th>
      <td><p>Preliminary number of iterations default <code>preit = 20</code></p></td>
    </tr>
    <tr>
      <th>randomZ</th>
      <td><p>logical; If <code>randomZ = TRUE</code> random initialization for the latent positions is used. If <code>randomZ = FALSE</code> and <code>D</code> = 2 or 3 the latent positions are initialized using the Fruchterman-Reingold method and multidimensional scaling is used for <code>D</code> = 1 or <code>D</code> &gt; 3. Default <code>randomZ = FALSE</code></p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>List containing:</p><ul>
<li><p><code>EZ</code> (<code>N</code> x <code>D</code>) matrix containing the posterior means of the latent positions</p></li>
<li><p><code>VZ</code> (<code>D</code> x <code>D</code>) matrix containing the posterior variance of the latent positions</p></li>
<li><p><code>lsmEZ</code> list contatining a (<code>N</code> x <code>D</code>) matrix for each network view containing the posterior means of the latent positions under each model in the latent space.</p></li>
<li><p><code>lsmVZ</code> list contatining a (<code>D</code> x <code>D</code>) matrix for each network view containing the posterior variance of the latent positions under each model in the latent space.</p></li>
<li><p><code>xiT</code> vector of means of the posterior distributions of \(\alpha\)</p></li>
<li><p><code>psi2T</code> vector of variances of the posterior distributions of \(\alpha\)</p></li>
<li><p><code>Ell</code> expected log-likelihood</p></li>
</ul>

    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Gollini, I., and Murphy, T. B. (2016), 'Joint Modelling of Multiple Network Views', Journal of Computational and Graphical Statistics, 25(1), 246-265 <a href='http://arxiv.org/abs/1301.3759'>http://arxiv.org/abs/1301.3759</a>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Simulate Undirected Network</span>
  <span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fl'>20</span>
  <span class='no'>Ndata</span> <span class='kw'>&lt;-</span> <span class='fl'>2</span>
   <span class='no'>Y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>()
   <span class='no'>Y</span><span class='kw'>[[</span><span class='fl'>1</span>]] <span class='kw'>&lt;-</span> <span class='fu'>network</span>(<span class='no'>N</span>, <span class='kw'>directed</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)[,]
   <span class='co'>### create a new view that is similar to the original</span>

  <span class='kw'>for</span>(<span class='no'>nd</span> <span class='kw'>in</span> <span class='fl'>2</span>:<span class='no'>Ndata</span>){
    <span class='no'>Y</span><span class='kw'>[[</span><span class='no'>nd</span>]] <span class='kw'>&lt;-</span> <span class='no'>Y</span><span class='kw'>[[</span><span class='no'>nd</span> - <span class='fl'>1</span>]] - <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sample'>sample</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(-<span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span>), <span class='no'>N</span> * <span class='no'>N</span>, <span class='kw'>replace</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
   <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>.05</span>, <span class='fl'>.85</span>, <span class='fl'>.1</span>))
    <span class='no'>Y</span><span class='kw'>[[</span><span class='no'>nd</span>]] <span class='kw'>&lt;-</span> <span class='fl'>1</span> * (<span class='no'>Y</span><span class='kw'>[[</span><span class='no'>nd</span>]]  <span class='kw'>&gt;</span> <span class='fl'>0</span> )
  <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='no'>Y</span><span class='kw'>[[</span><span class='no'>nd</span>]]) <span class='kw'>&lt;-</span> <span class='fl'>0</span>
   }

<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/par'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>))
<span class='no'>z</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='plotY.html'>plotY</a></span>(<span class='no'>Y</span><span class='kw'>[[</span><span class='fl'>1</span>]], <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>'Network 1'</span>)
<span class='fu'><a href='plotY.html'>plotY</a></span>(<span class='no'>Y</span><span class='kw'>[[</span><span class='fl'>2</span>]], <span class='kw'>EZ</span> <span class='kw'>=</span> <span class='no'>z</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>'Network 2'</span>)</div><div class='img'><img src='lsjm-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/par'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>))

<span class='no'>modLSJM</span> <span class='kw'>&lt;-</span> <span class='fu'>lsjm</span>(<span class='no'>Y</span>, <span class='kw'>D</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>modLSJM</span>, <span class='no'>Y</span>, <span class='kw'>drawCB</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='img'><img src='lsjm-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>modLSJM</span>, <span class='no'>Y</span>, <span class='kw'>drawCB</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>plotZtilde</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='img'><img src='lsjm-3.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Isabella Gollini.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

